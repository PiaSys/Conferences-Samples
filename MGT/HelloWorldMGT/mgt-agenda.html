<html>
    <head>
        <h1>Microsoft Graph Toolkit - Agenda Component</h1>
        <script src="https://unpkg.com/@microsoft/mgt/dist/bundle/mgt-loader.js"></script>

        <script>

            document.addEventListener('DOMContentLoaded', function() {

                let loginControl = document.getElementById('mgtLogin');
                let agendaControl = document.getElementById('mgtAgenda');
                loginControl.addEventListener('loginCompleted', function() {
                    agendaControl.style.display = 'block';
                });
                loginControl.addEventListener('logoutCompleted', function() {
                    agendaControl.style.display = 'none';
                });

            });

        </script>

    </head>
    <body>
        <h1>Hello World Microsoft Graph Toolkit!</h1>
        <mgt-msal-provider client-id="85c9403d-4c54-446a-b4b9-8b8922dac05c"></mgt-msal-provider>
        <mgt-login id="mgtLogin"></mgt-login>
        <mgt-agenda id="mgtAgenda" event-query="/me/events?orderby=start/dateTime" style="display: none;">
            <template data-type="event">
                <div>{{event.subject}}</div>
                <ul data-for="attendee in event.attendees">
                    <li>
                        <mgt-person
                        person-query="{{ attendee.emailAddress.name }}"
                        view="twolines">
                        </mgt-person>
                    </li>
                </ul>
            </template>
        </mgt-agenda>
    </body>
</html>