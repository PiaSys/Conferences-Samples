$token = ConvertTo-SecureString -String 'eyJ0eXAiOiJKV1QiLCJub25jZSI6ImQ5WTI5RFB2QlhHZWNVWWU2UUlKdmxSMHluTjNfbFB3X3U0ZEFwTDNkWlUiLCJhbGciOiJSUzI1NiIsIng1dCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyIsImtpZCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyJ9.eyJhdWQiOiJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC82Yzk0MDc1YS1kYTBhLTRjNmEtODQxMS1iYWRmNjUyZThiNTMvIiwiaWF0IjoxNjkzNDc3MDIyLCJuYmYiOjE2OTM0NzcwMjIsImV4cCI6MTY5MzQ4MTU2MSwiYWNjdCI6MCwiYWNyIjoiMSIsImFpbyI6IkFUUUF5LzhVQUFBQW9ZREJtbCtKVE1kZzFhMEhpWWRkRFR6TWI2Q3AwWGwwdGQzaE92Mk8vSkp1Um1ZbVJyaGs3MS85Z2Ryay80dzciLCJhbXIiOlsicHdkIl0sImFwcF9kaXNwbGF5bmFtZSI6IlBuUCBNYW5hZ2VtZW50IFNoZWxsIiwiYXBwaWQiOiIzMTM1OWM3Zi1iZDdlLTQ3NWMtODZkYi1mZGI4YzkzNzU0OGUiLCJhcHBpZGFjciI6IjAiLCJmYW1pbHlfbmFtZSI6IlBpYWxvcnNpIiwiZ2l2ZW5fbmFtZSI6IlBhb2xvIiwiaWR0eXAiOiJ1c2VyIiwiaXBhZGRyIjoiMi4yMzMuMTI0LjE3MyIsIm5hbWUiOiJQYW9sbyBQaWFsb3JzaSIsIm9pZCI6ImJlYTdhODQ4LTA0NTktNGJlZS05MDM0LTU1MTNlZTdmNjZlMCIsInBsYXRmIjoiMyIsInB1aWQiOiIxMDAzQkZGRDg2MEZBRDY5IiwicmgiOiIwLkFRc0FXZ2VVYkFyYWFreUVFYnJmWlM2TFV3TUFBQUFBQUFBQXdBQUFBQUFBQUFDRUFBdy4iLCJzY3AiOiJBbGxTaXRlcy5GdWxsQ29udHJvbCBBcHBDYXRhbG9nLlJlYWRXcml0ZS5BbGwgQXVkaXRMb2cuUmVhZC5BbGwgQm9va2luZ3MuUmVhZC5BbGwgQ2hhbm5lbE1lbWJlci5SZWFkV3JpdGUuQWxsIENoYW5uZWxNZXNzYWdlLlJlYWQuQWxsIENoYW5uZWxNZXNzYWdlLlNlbmQgQ2hhbm5lbFNldHRpbmdzLlJlYWRXcml0ZS5BbGwgQ2hhdC5SZWFkIENoYXQuUmVhZFdyaXRlIERpcmVjdG9yeS5BY2Nlc3NBc1VzZXIuQWxsIERpcmVjdG9yeS5SZWFkV3JpdGUuQWxsIEV4dGVybmFsQ29ubmVjdGlvbi5SZWFkV3JpdGUuQWxsIEdyb3VwLlJlYWRXcml0ZS5BbGwgSWRlbnRpdHlQcm92aWRlci5SZWFkV3JpdGUuQWxsIE1haWwuUmVhZC5TaGFyZWQgTWFpbC5SZWFkV3JpdGUgTWFpbC5TZW5kIE5vdGVzLlJlYWQuQWxsIFBsYWNlLlJlYWQuQWxsIFBvbGljeS5SZWFkLkFsbCBSZWNvcmRzTWFuYWdlbWVudC5SZWFkV3JpdGUuQWxsIFJlcG9ydHMuUmVhZC5BbGwgU2VjdXJpdHlFdmVudHMuUmVhZC5BbGwgU2VydmljZUhlYWx0aC5SZWFkLkFsbCBTZXJ2aWNlTWVzc2FnZS5SZWFkLkFsbCBTZXJ2aWNlTWVzc2FnZVZpZXdwb2ludC5Xcml0ZSBUYXNrcy5SZWFkV3JpdGUgVGVhbS5DcmVhdGUgVGVhbU1lbWJlci5SZWFkV3JpdGUuQWxsIFRlYW1zQXBwSW5zdGFsbGF0aW9uLlJlYWRXcml0ZUZvclVzZXIgVGVhbVNldHRpbmdzLlJlYWRXcml0ZS5BbGwgVGVhbXNUYWIuUmVhZFdyaXRlLkFsbCBUZXJtU3RvcmUuUmVhZFdyaXRlLkFsbCBVc2VyLkludml0ZS5BbGwgVXNlci5SZWFkLkFsbCBVc2VyLlJlYWRXcml0ZS5BbGwgcHJvZmlsZSBvcGVuaWQgZW1haWwiLCJzdWIiOiJieDJoWWFSTTNPQVhJTllXUHprUHBJRFdoLTEyaUhGbTNqQ3Z3WnJ4RVkwIiwidGVuYW50X3JlZ2lvbl9zY29wZSI6IkVVIiwidGlkIjoiNmM5NDA3NWEtZGEwYS00YzZhLTg0MTEtYmFkZjY1MmU4YjUzIiwidW5pcXVlX25hbWUiOiJwYW9sb0BQaWFTeXNEZXYub25taWNyb3NvZnQuY29tIiwidXBuIjoicGFvbG9AUGlhU3lzRGV2Lm9ubWljcm9zb2Z0LmNvbSIsInV0aSI6IjFic0FtUzJ6NzBXQ3lMcktmOHM3QUEiLCJ2ZXIiOiIxLjAiLCJ3aWRzIjpbIjYyZTkwMzk0LTY5ZjUtNDIzNy05MTkwLTAxMjE3NzE0NWUxMCIsImI3OWZiZjRkLTNlZjktNDY4OS04MTQzLTc2YjE5NGU4NTUwOSJdLCJ4bXNfc3QiOnsic3ViIjoiV3l0WUpITzFicWVDN0pIT1RfanZTcGNNcF9OdTllRFZQQkdydmZDSTFpSSJ9LCJ4bXNfdGNkdCI6MTM3MTQ3ODQ3MywieG1zX3RkYnIiOiJFVSJ9.b9MoDKZg1YAvfjCuMO2BTB_yurc22ICS39s4s5lV5KY5H7-gQg1t7S-2LXsA-x02DjSUXsplBdx4graj_S--M1LRvSz7GPE8HJY55clU-8q4-rvMAHiYQkIb0kVHbqFhhpHPYkdFxShmj4_hQI84x_OWcQ8Tf17zOJ0CHlUY4xlr6mGbvk6YYSFmsjOliA9Y8zzi4ILFC90MpUtgraWj-3i6vEAG1R3HMQVxBXFD1f9F4-dZe6fE-0A9vE32xQmTcyqWTDsqB-8IpAcPEGb2AoqUa9LJnyvp-4jcp_RolFEioKsI6JtmmrxtsarpqCtYbvRBVC51frp8AqOZUItvVA' -AsPlainText
Invoke-WebRequest -Uri 'https://graph.microsoft.com/v1.0/me' -Authentication Bearer -Token $token

try {
    Invoke-WebRequest -Uri 'https://graph.microsoft.com/v1.0/me' -Authentication Bearer -Token $token
}
catch {
    Write-Host "An error occurred:"
    Write-Host $_.Exception.Message

    if ($_.Exception.Message -match '429 \(Too Many Requests\)') {
        Write-Host 'You have been throttled!'
    }
}